<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Recommendations</title>

    <!-- Load global styling (includes NAVBAR styles) -->
    <link rel="stylesheet" href="{{ url_for('static', filename='style2.css') }}">

    <!-- Page-specific styling -->
    <link rel="stylesheet" href="{{ url_for('static', filename='recommendation.css') }}">
</head>

<body>

<!-- ⭐ NAVBAR ALWAYS SHOWN ON THIS PAGE -->
<nav class="navbar">
  <div class="nav-left">FindYourRSO</div>

  <div class="nav-right">
    <a href="/profile">Profile</a>
    <a href="/form">Find Clubs</a>
    <a href="/logout">Logout</a>
  </div>
</nav>

<!-- ⭐ Perfect spacing under navbar -->
<style>
    body { padding-top: 110px; }
</style>

<main>
    <div class="rec-card">

        <!-- Title Section -->
        <h2 class="title">FoundYourFit!</h2>
        <p class="subtitle">
            Here are some recommended clubs and organizations based on your interests!  
            Star the RSOs that you would like saved to your profile.
        </p>

        <!-- List of Recommendations -->
        <div class="list">
        {% for club_name in recommended_clubs %}
            <div class="rso-item" data-name="{{ club_name }}">
                <span class="name">{{ club_name }}</span>

                <!-- Auto-star if previously saved -->
                <svg class="star {% if club_name in saved_rso %}active{% endif %}" 
                     viewBox="0 0 24 24">
                    <path d="M12 .587l3.668 7.568L24 9.748l-6 5.848L19.335 24 
                             12 19.897 4.665 24 6 15.596 0 9.748l8.332-1.593z"/>
                </svg>
            </div>
        {% endfor %}
        </div>

        <!-- Submit starred clubs -->
        <form id="saveForm" action="/save_rso" method="POST">
            <input type="hidden" name="selected" id="selected-input">
            <button type="submit" class="button">Go to Profile</button>
        </form>

    </div>
</main>

<script>
    // Toggle star icon on click
    document.querySelectorAll('.star').forEach(star => {
        star.addEventListener('click', () => {
            star.classList.toggle('active');
        });
    });

    // Save starred RSOs before form submit
    document.getElementById("saveForm").addEventListener("submit", () => {
        const selectedNames = [];

        document.querySelectorAll(".rso-item").forEach(item => {
            const star = item.querySelector(".star");
            if (star.classList.contains("active")) {
                selectedNames.push(item.dataset.name);
            }
        });

        document.getElementById("selected-input").value =
            JSON.stringify(selectedNames);
    });
</script>

</body>
</html>
